(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){},23:function(e,t,a){},35:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAWCAYAAADXYyzPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEXSURBVHgBvZSBCYJAFIZ/j6goqDYoaoMGKGiRRgjawAYIWiBokIIGcAcdIDCCLAKtZxyked2d3fmBKMfzPT/f4znJC3xw3+0QrVaIfR+2iAGX5Q8b8zk6+316twkrPBwM0N5u04ueKyvMsWnPpAGW7NllNkMcBNJA0/bscTziPB7jttnIgw3ap786CUNcl0tUaZ/pcZX2X8NVlb1wqrl95LqQJilh75wYS1QSdw4HsH5fFpquWlq5tHqFMUUrU5QsHA6N2isZ5xOr2tO8kH1+WJWNMy9p2Du9Hlrr9ftDc/bahTlkEo5GSpNfm07R9Tw0F4v/CxNl7euTiX6PRej0HmV6LELHnjBWmKPae+OFCRV7K4U5v+yfW0isVFYNLj4AAAAASUVORK5CYII="},37:function(e,t,a){e.exports=a(71)},71:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(17),c=a.n(s),i=(a(22),a(36)),l=a(10),o=a(11),u=a(13),m=a(12),p=a(14),d=(a(23),a(1)),f=a.n(d),v=a(2),h=a(8),b={user:void 0},E=r.a.createContext(b);function N(e,t){return g.apply(this,arguments)}function g(){return(g=Object(v.a)(f.a.mark(function e(t,a){var n,r,s,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:if(!(n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:return s="",e.prev=9,e.next=12,n.json();case 12:c=e.sent,s=c.error,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),s=n.statusText;case 19:throw new Error(s);case 20:case"end":return e.stop()}},e,null,[[9,16]])}))).apply(this,arguments)}function x(e){return y.apply(this,arguments)}function y(){return(y=Object(v.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N("/api/destinations"));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(e,t){return O.apply(this,arguments)}function O(){return(O=Object(v.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N("/api/destinations/divesites/".concat(t,"/").concat(a)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var j={updateNote:function(){var e=Object(v.a)(f.a.mark(function e(t){var a,n,r,s,c,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.diveSiteId,n=t.user,r=t.content,s={"Content-Type":"application/json",Authorization:"Bearer ".concat(n.access_token)},c=JSON.stringify({content:r}),e.next=5,N("/api/notes/divesites/".concat(a,"/users/").concat(n.id),{method:"POST",headers:s,body:c});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getNote:function(){var e=Object(v.a)(f.a.mark(function e(t){var a,n,r,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.diveSiteId,n=t.user,r={"Content-Type":"application/json",Authorization:"Bearer ".concat(n.access_token)},e.next=4,N("/api/notes/divesites/".concat(a,"/users/").concat(n.id),{headers:r,methods:"POST"});case 4:if(null!=(s=e.sent)){e.next=7;break}return e.abrupt("return","");case 7:return e.abrupt("return",s.content);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},k={register:function(){var e=Object(v.a)(f.a.mark(function e(t){var a,n,r,s,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.email,r=t.password,s={method:"POST",body:JSON.stringify({username:a,email:n,password:r}),headers:{"Content-Type":"application/json"}},e.next=4,N("/auth/api-register",s);case 4:return c=e.sent,console.log("data",c),e.abrupt("return",this.login(n,r));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),login:function(){var e=Object(v.a)(f.a.mark(function e(t,a){var n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",body:JSON.stringify({email:t,password:a}),headers:{"Content-Type":"application/json"}},e.next=3,N("/auth/api-login",n);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),logout:function(){var e=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}},e.next=3,N("/auth/api-logout",a);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},A=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).logout=Object(v.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.logout(a.context.user.access_token);case 2:a.context.updateUser(null);case 3:case"end":return e.stop()}},e)})),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.context.user;return r.a.createElement("nav",{className:"navbar is-dark",id:"nav",role:"navigation","aria-label":"main navigation",style:{paddingLeft:10,paddingRight:10}},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("a",{href:"/",role:"button",className:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"},r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}))),r.a.createElement("div",{id:"navbarBasicExample",className:"navbar-menu"},r.a.createElement("div",{className:"navbar-start"},r.a.createElement("a",{href:"/",className:"navbar-item"},r.a.createElement("div",{className:"title",style:{paddingRight:20}},"Reefbase")),r.a.createElement(h.b,{className:"navbar-item",to:"/about"},"About"),r.a.createElement(h.b,{className:"navbar-item",to:"/destinations"},"Destinations")),null!=e?r.a.createElement("div",{className:"navbar-end"},r.a.createElement("a",{href:"/",className:"navbar-item"},e.username),r.a.createElement("a",{className:"navbar-item",onClick:this.logout},"Logout")):r.a.createElement("div",{className:"navbar-end"},r.a.createElement(h.b,{className:"navbar-item",to:"/login"},"Login"))))}}]),t}(r.a.Component);A.contextType=E;var S=A,C=(a(51),a(9)),U=a(4),T=a(34),B=a.n(T),I=a(35),R=a.n(I),L=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r))))._textarea=void 0,a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"syncNote",value:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.site.id,e.next=3,j.getNote({diveSiteId:t,user:this.context.user});case 3:a=e.sent,this._textarea.value=a;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=Object(v.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.context.user){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.syncNote();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(v.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.site.id!==t.site.id&&(this._textarea.value="",this.syncNote());case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onNoteSave",value:function(){var e=Object(v.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.site.id,e.next=3,j.updateNote({diveSiteId:a,user:this.context.user,content:this._textarea.value});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this,a=this.props.site;return null==a?r.a.createElement("div",null,r.a.createElement("h2",{className:"title is-two"},"No Dive Site Selected!")):(e=null!=this.context.user?r.a.createElement("div",{className:"full-height"},r.a.createElement("textarea",{autoFocus:!0,className:"textarea",placeholder:"Take notes here.",ref:function(e){return t._textarea=e}}),r.a.createElement("button",{className:"button",onClick:this.onNoteSave.bind(this)},"submit")):r.a.createElement("div",null,r.a.createElement("textarea",{className:"textarea",placeholder:"Please login to take notes",disabled:!0})),r.a.createElement("div",null,r.a.createElement("h2",{className:"title is-two"},a.name),r.a.createElement("h3",{className:"subtitle is-four"},a.destination,", ",a.country),e))}}]),t}(r.a.Component);L.contextType=E;var P=L,D=function(e){var t=e.site,a=(e.lat,e.lng,e.clickHandler),n=void 0===a?function(){}:a;return r.a.createElement("img",{className:"tooltip",onClick:n,src:R.a,alt:"Diver Down Flag","data-tooltip":t.name,style:{boxShadow:"0px 4px 4px rgba(0, 0, 0, 0.25)",cursor:"pointer"}})};var W=function(e){var t=Object(n.useState)([]),a=Object(U.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(null),l=Object(U.a)(i,2),o=l[0],u=l[1],m=Object(n.useState)(null),p=Object(U.a)(m,2),d=p[0],h=p[1];return Object(n.useEffect)(function(){Object(v.a)(f.a.mark(function t(){var a,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e.match.params.country,e.match.params.name);case 2:a=t.sent,u(a),console.log("result",a),n=a.divesites||[],c(n),n.length>0&&h(n[0]);case 8:case"end":return t.stop()}},t)}))()},[e.match.params.country,e.match.params.name]),r.a.createElement("div",null,r.a.createElement("div",{style:{height:"100vh",width:"100%",position:"fixed",top:0}},null!=o&&r.a.createElement(B.a,{bootstrapURLKeys:{key:"AIzaSyCaxeoUHkl2GK3sKFaNvLfoRWMTm0EbzK0"},defaultCenter:o,defaultZoom:o.zoom_level},s.map(function(e){return r.a.createElement(D,{key:e.id,lat:e.lat,lng:e.lng,site:e,clickHandler:function(){h(e)}})}))),r.a.createElement("div",{id:"content"},null!=d?r.a.createElement("section",{className:"section"},r.a.createElement("div",{className:"container is-fluid"},r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column is-three-quarters"}),r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"tile box is-vertical",id:"main-content"},r.a.createElement(P,{site:d,isLoggedIn:!0})))))):null))},H=function(e){var t=e.dest;return r.a.createElement(h.b,{className:"box",to:"/destinations/".concat(t.country,"/").concat(t.name),style:{margin:10,height:250,width:250,background:"#102D54"}},r.a.createElement("div",{className:"title is-4",style:{color:"white",height:"100%",verticalAlign:"center"}},t.name))},J=function(e){return r.a.createElement("div",{className:"level"},e.children)};var K=function(){var e=Object(n.useState)(!0),t=Object(U.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)([]),i=Object(U.a)(c,2),l=i[0],o=i[1];return Object(n.useEffect)(function(){Object(v.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:t=e.sent,o(t),s(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])}))()},[]),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"container"},r.a.createElement(J,null,r.a.createElement("h1",{className:"title is-3",style:{paddingLeft:23}},"Destinations")),r.a.createElement(J,null,a?r.a.createElement("div",{className:"box is-loading",style:{background:"#102D54"}},"Loading"):null,r.a.createElement("div",{className:"tile is-parent"},l.map(function(e){return r.a.createElement(H,{dest:e,key:e.id})})))))},z=function(e){var t=Object(n.useState)(""),a=Object(U.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(""),l=Object(U.a)(i,2),o=l[0],u=l[1],m=Object(n.useState)(null),p=Object(U.a)(m,2),d=p[0],h=p[1];function b(){return(b=Object(v.a)(f.a.mark(function t(a){var n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,k.login(s,o);case 4:n=t.sent,e.context.updateUser(n),e.history.push("/"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),h(t.t0.message);case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}},t,null,[[1,9]])}))).apply(this,arguments)}return r.a.createElement("form",{onSubmit:function(e){return b.apply(this,arguments)}},r.a.createElement("h3",{className:"title has-text-grey"},"Login"),r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"field"},r.a.createElement("p",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"email",placeholder:"Email",value:s,onChange:function(e){c(e.target.value)}}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-envelope"})))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Password",value:o,onChange:function(e){u(e.target.value)}}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-lock"})))),r.a.createElement("button",{className:"button is-block is-info is-fullwidth",type:"submit"},"Login"),null!=d?r.a.createElement("p",{class:"help is-danger"},d):null))},M=function(e){var t=Object(n.useState)(""),a=Object(U.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(""),l=Object(U.a)(i,2),o=l[0],u=l[1],m=Object(n.useState)(""),p=Object(U.a)(m,2),d=p[0],h=p[1],b=Object(n.useState)(null),E=Object(U.a)(b,2),N=E[0],g=E[1];function x(){return(x=Object(v.a)(f.a.mark(function t(a){var n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,k.register({username:d,email:s,password:o});case 4:n=t.sent,e.context.updateUser(n),e.history.push("/"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),g(t.t0.message);case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}},t,null,[[1,9]])}))).apply(this,arguments)}return r.a.createElement("form",{onSubmit:function(e){return x.apply(this,arguments)}},r.a.createElement("h3",{className:"title has-text-grey"},"Register"),r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"field"},r.a.createElement("p",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"text",placeholder:"Username",value:d,onChange:function(e){h(e.target.value)}}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-user"})))),r.a.createElement("div",{className:"field"},r.a.createElement("p",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"email",placeholder:"Email",value:s,onChange:function(e){c(e.target.value)}}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-envelope"})))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",type:"password",placeholder:"Password",value:o,onChange:function(e){u(e.target.value)}}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-lock"})))),r.a.createElement("button",{className:"button is-block is-info is-fullwidth",submit:"submit"},"Register")),null!=N?r.a.createElement("p",{class:"help is-danger"},N):null)},Y=Object(C.e)(function(e){return r.a.createElement(E.Consumer,null,function(t){return r.a.createElement("section",{className:"hero is-fullheight"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container has-text-centered"},r.a.createElement("div",{className:"column is-4 is-offset-4"},r.a.createElement(z,Object.assign({},e,{context:t}))),r.a.createElement("div",{className:"column is-4 is-offset-4"},r.a.createElement(M,Object.assign({},e,{context:t}))))))})});function F(e){return r.a.createElement(W,e)}function X(){return r.a.createElement("h2",null,"About")}var _=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state=b,a.updateUser=function(e){a.setState({user:e}),localStorage.setItem("user",JSON.stringify(e))};var n=localStorage.getItem("user");return null!=n&&(a.state.user=JSON.parse(n)),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(E.Provider,{value:Object(i.a)({},this.state,{updateUser:this.updateUser})},r.a.createElement(h.a,null,r.a.createElement("div",null,r.a.createElement(S,null),r.a.createElement(C.b,{exact:!0,path:"/",render:function(){return r.a.createElement(C.a,{to:"/destinations"})}}),r.a.createElement(C.b,{path:"/login/",component:Y}),r.a.createElement(C.b,{path:"/about/",component:X}),r.a.createElement(C.b,{path:"/destinations/",exact:!0,component:K}),r.a.createElement(C.b,{path:"/destinations/:country/:name",component:F}))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(_,null),document.getElementById("page")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[37,1,2]]]);
//# sourceMappingURL=main.6a7b0281.chunk.js.map